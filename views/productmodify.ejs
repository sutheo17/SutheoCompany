<%- include('header', {pagetitle: 'ProductModify'}) -%>
<div class="container mt-4">
  <form method="POST" action="/product/add" enctype="multipart/form-data">
    <div class="row mt-4">
      <div class="col-md-12">
        <table class="table table-custom-product-modify">
          <tr>
            <td class="col-3 align-middle text-center" rowspan="6">
              <img src="https://placehold.co/310x250" class="img-fluid mb-2" alt="Item Image">
              <div>
                <input type="file" name="photo" class="form-control mb-2">
              </div>
            </td>
            <td class="col-6">
              Name:
              <input type="text" name="name" class="form-control text-danger" placeholder="Name" required>
            </td>
          </tr>
          <tr>
            <td class="col-6">
              Item number:
              <input type="text" name="item_number" class="form-control text-danger" placeholder="Item number" required>
            </td>
          </tr>
          <tr>
            <td>
              <div class="row">
                <div class="col-md-6">
                  Category:
                  <select name="category" id="categorySelect" class="form-control text-danger" required>
                    <option value="">-- Select --</option>
                    <option value="discrete">discrete</option>
                    <option value="sheet">sheet</option>
                  </select>
                </div>

                <!-- Sub-category OR Color -->
                <div class="col-md-6" id="subColorGroup" style="display: none;">
                  <label id="subColorLabel">Sub-category:</label>
                  <input type="text" name="subcategory" class="form-control text-danger" id="subColorInput" placeholder="">
                </div>
              </div>
            </td>
          </tr>

          <!-- Manufacturer + Supplier: mindig jelenik meg ha kiválasztott a kategória -->
          <tr id="manufacturerSupplierRow" style="display: none;">
            <td>
              <div class="row">
                <div class="col-md-6">
                  Manufacturer:
                  <input type="text" name="manufacturer" class="form-control text-danger" placeholder="Manufacturer">
                </div>
                <div class="col-md-6">
                  Supplier:
                  <input type="text" name="supplier" class="form-control text-danger" placeholder="Supplier">
                </div>
              </div>
            </td>
          </tr>

          <!-- In Stock OR Size + Thickness -->
          <tr id="variantFieldsRow" style="display: none;">
            <td>
              <div class="row" id="discreteFields" style="display: none;">
                <div class="col-md-12">
                  In stock:
                  <input type="number" name="in_stock" class="form-control text-danger" value="0" min="0">
                </div>
              </div>
              <div class="row" id="sheetFields" style="display: none;">
                <div class="col-md-6">
                  Size(s) (mm):
                  <input type="text" name="sizes" class="form-control text-danger" placeholder="[height]x[width]x[pieces] format">
                </div>
                <div class="col-md-6">
                  Thickness (mm):
                  <input type="number" name="thickness" class="form-control text-danger" placeholder="Thickness in mm" min="0" step="0.01">
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="2">
              <button type="submit" class="btn btn-success">Save</button>
              <a href="/transaction/product" class="btn btn-secondary">Cancel</a>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </form>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const categorySelect = document.getElementById('categorySelect');
    const subColorGroup = document.getElementById('subColorGroup');
    const subColorLabel = document.getElementById('subColorLabel');
    const subColorInput = document.getElementById('subColorInput');
    const manufacturerSupplierRow = document.getElementById('manufacturerSupplierRow');
    const variantFieldsRow = document.getElementById('variantFieldsRow');
    const discreteFields = document.getElementById('discreteFields');
    const sheetFields = document.getElementById('sheetFields');

    function toggleFields() {
      const value = categorySelect.value;

      const show = value !== '';
      subColorGroup.style.display = show ? '' : 'none';
      manufacturerSupplierRow.style.display = show ? '' : 'none';
      variantFieldsRow.style.display = show ? '' : 'none';

      if (value === 'discrete') {
        subColorLabel.innerText = 'Sub-category:';
        subColorInput.name = 'subcategory';
        subColorInput.placeholder = 'Sub-category';

        discreteFields.style.display = '';
        sheetFields.style.display = 'none';
      } else if (value === 'sheet') {
        subColorLabel.innerText = 'Color:';
        subColorInput.name = 'color';
        subColorInput.placeholder = 'Color';

        discreteFields.style.display = 'none';
        sheetFields.style.display = '';
      } else {
        subColorGroup.style.display = 'none';
        manufacturerSupplierRow.style.display = 'none';
        variantFieldsRow.style.display = 'none';
      }
    }

    categorySelect.addEventListener('change', toggleFields);
    toggleFields(); // page load init
  });
</script>
<%- include('footer') -%>